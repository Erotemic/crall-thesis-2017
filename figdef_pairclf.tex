

\edef\pzcode{PZ_PB_RF_TRAIN_2567}
\edef\gzcode{GZ_Master1_20029}
%\edef\gzcode{GZ_Master1_222}



\newcommand{\MatchStateExample}{
\begin{figure}[ht!]
\centering
\begin{subfigure}[h]{0.26\textwidth}
\centering
\includegraphics[height=160pt]{figures_pairclf/classesC.png}\caption{positive}\label{sub:classesC}
\end{subfigure}
\begin{subfigure}[h]{0.31\textwidth}
\centering
\includegraphics[height=160pt]{figures_pairclf/classesA.png}\caption{negative}\label{sub:classesA}
\end{subfigure}
\begin{subfigure}[h]{0.31\textwidth}
\centering
\includegraphics[height=160pt]{figures_pairclf/classesB.png}\caption{incomparable}\label{sub:classesB}
\end{subfigure}
\caption[\caplbl{MatchStateExample}Match state example]{\caplbl{MatchStateExample}
% ---
Examples of positive (\ref{sub:classesC}), negative  (\ref{sub:classesA}), and
  incomparable (\ref{sub:classesB}) pairs of annotations.
Local feature correspondences are superimposed over the pairs.
% ---
}
\label{fig:MatchStateExample}
\end{figure}
}


\newcommand{\PositiveHist}{
\begin{figure}[ht!]
\centering
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\pzcode/score_hist_lnbnn.png}
\caption{Plains zebras LNBNN}\label{sub:pos_lnbnn_hist_pz}
\end{subfigure}
~
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\pzcode/score_hist_pos_learn(sum,glob).png}
\caption{Plains zebras learned}\label{sub:pos_hist_pz}
\end{subfigure}
~
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\gzcode/score_hist_lnbnn.png}
\caption{Grévy's zebras LNBNN}\label{sub:pos_lnbnn_hist_gz}
\end{subfigure}
~
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\gzcode/score_hist_pos_learn(sum,glob).png}
\caption{Grévy's zebras learned}\label{sub:pos_hist_gz}
\end{subfigure}
%~

\caption[\caplbl{PositiveHist}Positive scores]{\caplbl{PositiveHist}
% ---
Positive scores of LNBNN (left) and pairiwse (right) matching for plains (top)
and Grévy's (bottom) zebras. In addition to being more interpretable than LNBNN
scores the learned probabilities exhibit better separability.
% ---
}
\label{fig:PositiveHist}
\end{figure}
}



\newcommand{\PositiveROC}{
\begin{figure}[ht!]
\centering
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\pzcode/roc_match_state.png}
\caption{Plains zebra}\label{sub:pos_roc_pz}
\end{subfigure}
~
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\gzcode/roc_match_state.png}
\caption{Grévy's zebra}\label{sub:pos_roc_gz}
\end{subfigure}
\caption[\caplbl{PositiveROC}Positive match state ROC]{\caplbl{PositiveROC}
% ---
Positive match state ROC.
% ---
}
\label{fig:PositiveROC}
\end{figure}
}


\begin{comment}
    python -m ibeis.scripts.thesis ExptChapter4.write_metrics --db GZ_Master1 --task-key=match_state
    python -m ibeis.scripts.thesis ExptChapter4.write_metrics --db PZ_PB_RF_TRAIN --task-key=match_state
\end{comment}
\newcommand{\ConfusionMatch}{
\begin{table}
    \centering

    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\pzcode/confusion_match_state.tex}
        \caption{Plains zebras match state confusion}
    \end{subtable} %

    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\gzcode/confusion_match_state.tex}
        \caption{Grévy zebras match state confusion}
    \end{subtable} %
\caption[\caplbl{ConfusionMatch}Match state confusion]{\caplbl{ConfusionMatch}
% ---
Multiclass match state confusion for plains and Grévy's zebras. The rows are
the real (groundtruth) state and the columns are the predicted states.  The
final column indicates the number of examples for each class in the testing
dataset. 
% ---
}
\label{tbl:ConfusionMatch}
\end{table}
}


\newcommand{\EvalMetricsMatch}{
\begin{table}
    \centering
    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\pzcode/eval_metrics_match_state.tex}
        \caption{Plains zebras match state metrics}
    \end{subtable} %

    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\gzcode/eval_metrics_match_state.tex}
        \caption{Grévy zebras match state metrics}
    \end{subtable} %
\caption[\caplbl{EvalMetricsMatch}Match state metrics]{\caplbl{EvalMetricsMatch}
% ---
Multiclass match state evaluation metrics for plains and Grévy's zebras
computed from the confusion matrix.
% ---
}

\label{tbl:EvalMetricsMatch}
\end{table}
}

\begin{comment}
    python -m ibeis.scripts.script_vsone report_classifier_importance --db PZ_PB_RF_TRAIN \
    --dpath ~/latex/crall-thesis-2017/ --save "figures_pairclf/wc_pz_clipwhite2.png" \
    --clipwhite --diskshow

    python -m ibeis.scripts.script_vsone report_classifier_importance --db GZ_Master1 \
    --dpath ~/latex/crall-thesis-2017/ --save "figures_pairclf/wc_gz_clipwhite2.png" \
    --clipwhite --diskshow
\end{comment}

\newcommand{\MatchWordCloud}{
\begin{figure}[ht!]
\centering
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\pzcode/wc_match_state.png}
\caption{Plains zebra}\label{sub:wc_pz}
\end{subfigure}
~
\begin{subfigure}[h]{0.47\textwidth}
\centering
\includegraphics[width=\textwidth]{figures_pairclf/\expandafter\gzcode/wc_match_state.png}
\caption{Grévy's zebra}\label{sub:wc_gz}
\end{subfigure}
\caption[\caplbl{MatchWordCloud}Word cloud of important features for matching]{\caplbl{MatchWordCloud}
% ---
Word cloud of important features for predicting match state. The difference in
viewpoint (denoted as global(view\_delta)) has high importance because of its
role in distinguishing incomparable cases.
% ---
}
\label{fig:MatchWordCloud}
\end{figure}
}

\newcommand{\ImportantMatchFeat}{
\begin{table}
    \centering
    \begin{subtable}[h]{0.44\textwidth}
        \centering
        \begin{tabular}{l c}
            \toprule
            dimension & importance\\
            \midrule
            \input{figures_pairclf/\expandafter\pzcode/feat_importance_match_state.tex}
            \bottomrule
        \end{tabular}
        \caption{Plains zebra}
    \end{subtable} %
    \begin{subtable}[h]{0.44\textwidth}
        \centering
        \begin{tabular}{l c}
            \toprule
            dimension & importance\\
            \midrule
            \input{figures_pairclf/\expandafter\gzcode/feat_importance_match_state.tex}
            \bottomrule
        \end{tabular}
        \caption{Grévy's zebra}
    \end{subtable} %
\caption[\caplbl{ImportantMatchFeat}Important features for match prediction]{
% ---
    \caplbl{ImportantMatchFeat} Top $5$ most important features for predicting
    that matching state (positive, negative, incomparable) for a pair of
    annotations. 
    %The sum of the importance for all $205$ feature dimensions is $1$.
% ---
}
\label{tbl:ImportantMatchFeat}
\end{table}
}




\begin{comment}
    python -m ibeis.scripts.thesis ExptChapter4.write_metrics --db GZ_Master1 --task-key=photobomb_state
    python -m ibeis.scripts.thesis ExptChapter4.write_metrics --db PZ_PB_RF_TRAIN --task-key=photobomb_state
\end{comment}
\newcommand{\ConfusionPhotobomb}{

\begin{table}[ht!]
    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\pzcode/confusion_photobomb_state.tex}
        \caption{Plains zebra photobomb confusion}
    \end{subtable} %

    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\gzcode/confusion_photobomb_state.tex}
        \caption{Grévy's zebra photobomb confusion}
    \end{subtable} %
\caption[\caplbl{ConfusionPhotobomb}Photobomb state confusion]{\caplbl{ConfusionPhotobomb}
% ---
Photobomb state confusion for plains and Grévy's zebras.
The classes pb and notpb respectively indicate if a pair is or is not a
photobomb.
The columns indicate predicted classes and the rows rows indicate real (groundtruth) classes.
The final column indicates the number of examples of each class in the testing
dataset.
% ---
}

\label{tbl:ConfusionPhotobomb}
\end{table}
}

\newcommand{\EvalMetricsPhotobomb}{
\begin{table}
    \centering
    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\pzcode/eval_metrics_photobomb_state.tex}
        \caption{Plains zebras photobomb metrics}
    \end{subtable} %

    \begin{subtable}[h]{\textwidth}
        \centering
        \input{figures_pairclf/\expandafter\gzcode/eval_metrics_photobomb_state.tex}
        \caption{Grévy zebras photobomb metrics}
    \end{subtable} %
\caption[\caplbl{EvalMetricsPhotobomb}Match state metrics]{\caplbl{EvalMetricsPhotobomb}
% ---
Photobomb state evaluation metrics for plains and Grévy's zebras computed from
the confusion matrix.
% ---
}

\label{tbl:EvalMetricsPhotobomb}
\end{table}
}


\newcommand{\ImportantPBFeat}{
    \begin{table}
        \centering 
        \begin{subtable}[h]{0.44\textwidth} 
            \centering
            \begin{tabular}{l c}
                \toprule dimension & importance\\
                \midrule
                \input{figures_pairclf/\expandafter\pzcode/feat_importance_photobomb_state.tex}
                \bottomrule
            \end{tabular}
            \caption{Plains zebra phototomb importance}
        \end{subtable} %
        ~~~~ 
        \begin{subtable}[h]{0.44\textwidth}
            \centering 
            \begin{tabular}{l c}
                \toprule
                dimension & importance\\ 
                \midrule
                \input{figures_pairclf/\expandafter\gzcode/feat_importance_photobomb_state.tex}
                \bottomrule
            \end{tabular}
            \caption{Grévy's zebra phototomb importance}
        \end{subtable} %
        \caption[\caplbl{ImportantPBFeat}Important features for photobomb prediction]{
% ---
            \caplbl{ImportantPBFeat} Top $5$ most important features for predicting if
            a pair of annotations has a photobomb.  Notice that these features are
            related to the spatial location of the matches and to global information
            like speed that might preclude a match from occuring. Annotations taken at
            the same time and place are more likely to contain photobombs.
% ---
        }
        \label{tbl:ImportantPBFeat}
    \end{table}
}
